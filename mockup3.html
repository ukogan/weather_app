<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>Mockup 3: Weather Spiral - 48 Hour Radial Forecast</title>
  <style>
    :root {
      --background: #0e0b20;
      --foreground: #f5f5f7;
      --secondary: rgba(255, 255, 255, 0.72);
      --panel-bg: rgba(28, 26, 45, 0.9);
      --panel-border: rgba(255, 255, 255, 0.1);
      --accent: #64b5ff;
      font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      background: linear-gradient(180deg, #17132f 0%, #0e0b20 100%);
      color: var(--foreground);
      min-height: 100vh;
      padding: 20px;
      overflow: hidden;
    }

    .container {
      max-width: 428px;
      margin: 0 auto;
      height: 100vh;
      display: flex;
      flex-direction: column;
    }

    .header {
      text-align: center;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 24px;
      font-weight: 600;
      margin-bottom: 8px;
    }

    .subtitle {
      color: var(--secondary);
      font-size: 14px;
    }

    /* Radial Container */
    .radial-container {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
      min-height: 350px;
    }

    .spiral-svg {
      width: 100%;
      max-width: 350px;
      height: auto;
      aspect-ratio: 1;
      transform: rotate(-90deg);
      transition: transform 0.3s ease;
    }

    .spiral-svg.interactive {
      cursor: pointer;
    }

    /* Center Display */
    .center-display {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
      background: var(--panel-bg);
      backdrop-filter: blur(24px);
      border-radius: 50%;
      width: 140px;
      height: 140px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 2px solid var(--panel-border);
      pointer-events: none;
    }

    .center-time {
      font-size: 12px;
      color: var(--secondary);
      margin-bottom: 4px;
    }

    .center-temp {
      font-size: 36px;
      font-weight: 600;
      margin-bottom: 4px;
    }

    .center-condition {
      font-size: 11px;
      color: var(--accent);
    }

    /* Time Labels */
    .time-labels {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
    }

    .time-label {
      position: absolute;
      font-size: 10px;
      color: var(--secondary);
      transform: translate(-50%, -50%);
      background: var(--background);
      padding: 2px 4px;
      border-radius: 4px;
    }

    /* Legend */
    .legend {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
      padding: 12px;
      background: var(--panel-bg);
      border-radius: 12px;
    }

    .legend-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
    }

    .legend-icon {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .legend-label {
      font-size: 11px;
      color: var(--secondary);
    }

    /* Control Panel */
    .control-panel {
      background: var(--panel-bg);
      border-radius: 18px;
      padding: 16px;
      margin-bottom: 20px;
    }

    .metric-selector {
      display: flex;
      gap: 8px;
      margin-bottom: 16px;
    }

    .metric-button {
      flex: 1;
      padding: 8px;
      background: rgba(255, 255, 255, 0.05);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 8px;
      color: var(--secondary);
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      text-align: center;
    }

    .metric-button.active {
      background: var(--accent);
      color: white;
      border-color: var(--accent);
    }

    /* Detail Card */
    .detail-card {
      background: var(--panel-bg);
      border-radius: 12px;
      padding: 16px;
      position: fixed;
      bottom: 20px;
      left: 20px;
      right: 20px;
      max-width: 388px;
      margin: 0 auto;
      transform: translateY(150%);
      transition: transform 0.3s ease;
      z-index: 100;
    }

    .detail-card.active {
      transform: translateY(0);
    }

    .detail-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .detail-time {
      font-size: 16px;
      font-weight: 600;
    }

    .detail-close {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: rgba(255, 255, 255, 0.1);
      border: none;
      color: var(--secondary);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .detail-metrics {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
    }

    .detail-metric {
      text-align: center;
    }

    .detail-value {
      font-size: 18px;
      font-weight: 600;
      margin-bottom: 2px;
    }

    .detail-label {
      font-size: 10px;
      color: var(--secondary);
      text-transform: uppercase;
    }

    /* Touch Hints */
    .touch-hints {
      text-align: center;
      color: var(--secondary);
      font-size: 12px;
      padding: 12px;
      display: flex;
      justify-content: center;
      gap: 16px;
    }

    .hint-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    /* Rotation Animation */
    @keyframes rotate {
      from { transform: rotate(-90deg); }
      to { transform: rotate(270deg); }
    }

    .spiral-svg.animating {
      animation: rotate 20s linear infinite;
    }

    /* UX Notes */
    .ux-notes {
      background: rgba(255, 255, 255, 0.05);
      border-radius: 12px;
      padding: 16px;
      margin-top: 20px;
    }

    .ux-notes h3 {
      font-size: 14px;
      margin-bottom: 8px;
      color: var(--accent);
    }

    .ux-notes ul {
      font-size: 13px;
      color: var(--secondary);
      line-height: 1.6;
      padding-left: 20px;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>48-Hour Spiral</h1>
      <p class="subtitle">San Carlos, CA â€¢ Radial Weather View</p>
    </div>

    <!-- Metric Selector -->
    <div class="control-panel">
      <div class="metric-selector">
        <div class="metric-button active" data-metric="temperature">Temp</div>
        <div class="metric-button" data-metric="precipitation">Precip</div>
        <div class="metric-button" data-metric="wind">Wind</div>
        <div class="metric-button" data-metric="combined">All</div>
      </div>
    </div>

    <!-- Radial Visualization -->
    <div class="radial-container">
      <svg class="spiral-svg interactive" viewBox="0 0 400 400" id="spiral">
        <defs>
          <!-- Temperature Gradient -->
          <linearGradient id="tempGradient">
            <stop offset="0%" stop-color="#64b5ff"/>
            <stop offset="25%" stop-color="#66bb6a"/>
            <stop offset="50%" stop-color="#ffeb3b"/>
            <stop offset="75%" stop-color="#ff7043"/>
            <stop offset="100%" stop-color="#ef5350"/>
          </linearGradient>

          <!-- Precipitation Gradient -->
          <radialGradient id="precipGradient">
            <stop offset="0%" stop-color="rgba(100, 181, 255, 0.8)"/>
            <stop offset="100%" stop-color="rgba(100, 181, 255, 0.1)"/>
          </radialGradient>
        </defs>

        <!-- Background circles for reference -->
        <g id="grid-circles"></g>

        <!-- Main spiral path -->
        <g id="spiral-path"></g>

        <!-- Hour markers -->
        <g id="hour-markers"></g>

        <!-- Data visualization -->
        <g id="data-viz"></g>

        <!-- Interactive overlay -->
        <g id="interactive-layer"></g>
      </svg>

      <!-- Center Display -->
      <div class="center-display">
        <div class="center-time">NOW</div>
        <div class="center-temp" id="currentTemp">68Â°</div>
        <div class="center-condition">Clear</div>
      </div>

      <!-- Time Labels -->
      <div class="time-labels" id="timeLabels"></div>
    </div>

    <!-- Legend -->
    <div class="legend">
      <div class="legend-item">
        <div class="legend-icon" style="background: linear-gradient(90deg, #64b5ff, #ef5350)"></div>
        <span class="legend-label">Temperature</span>
      </div>
      <div class="legend-item">
        <div class="legend-icon" style="background: #64b5ff"></div>
        <span class="legend-label">Precipitation</span>
      </div>
      <div class="legend-item">
        <div class="legend-icon" style="background: #9575cd"></div>
        <span class="legend-label">Wind</span>
      </div>
    </div>

    <!-- Touch Hints -->
    <div class="touch-hints">
      <div class="hint-item">
        <span>ðŸ”„</span>
        <span>Rotate to explore</span>
      </div>
      <div class="hint-item">
        <span>ðŸ‘†</span>
        <span>Tap for details</span>
      </div>
    </div>

    <!-- Detail Card -->
    <div class="detail-card" id="detailCard">
      <div class="detail-header">
        <div class="detail-time" id="detailTime">--</div>
        <button class="detail-close" onclick="closeDetail()">âœ•</button>
      </div>
      <div class="detail-metrics">
        <div class="detail-metric">
          <div class="detail-value" id="detailTemp">--Â°</div>
          <div class="detail-label">Temp</div>
        </div>
        <div class="detail-metric">
          <div class="detail-value" id="detailPrecip">--%</div>
          <div class="detail-label">Precip</div>
        </div>
        <div class="detail-metric">
          <div class="detail-value" id="detailWind">-- mph</div>
          <div class="detail-label">Wind</div>
        </div>
        <div class="detail-metric">
          <div class="detail-value" id="detailHumidity">--%</div>
          <div class="detail-label">Humidity</div>
        </div>
        <div class="detail-metric">
          <div class="detail-value" id="detailDew">--Â°</div>
          <div class="detail-label">Dew Pt</div>
        </div>
        <div class="detail-metric">
          <div class="detail-value" id="detailClouds">--%</div>
          <div class="detail-label">Clouds</div>
        </div>
      </div>
    </div>

    <!-- UX Notes -->
    <div class="ux-notes">
      <h3>UX Interaction Patterns</h3>
      <ul>
        <li><strong>Radial Time:</strong> Each ring represents 12 hours, spiraling outward for 48 hours</li>
        <li><strong>Color Mapping:</strong> Ring segments colored by temperature gradient</li>
        <li><strong>Precipitation:</strong> Blue dots/bars on the spiral indicate rain probability</li>
        <li><strong>Wind Direction:</strong> Small arrows point in wind direction along the spiral</li>
        <li><strong>Touch Rotation:</strong> Drag to rotate the spiral and explore different times</li>
        <li><strong>Tap for Details:</strong> Touch any segment to see detailed metrics</li>
        <li><strong>Metric Toggle:</strong> Switch between temperature, precipitation, wind, or combined view</li>
        <li><strong>Now Indicator:</strong> Center always shows current conditions</li>
      </ul>
    </div>
  </div>

  <script>
    // Temperature color function
    function getTemperatureColor(temp) {
      const TEMP_MIN = -20;
      const TEMP_MAX = 120;
      const normalized = Math.max(0, Math.min(1, (temp - TEMP_MIN) / (TEMP_MAX - TEMP_MIN)));

      const stops = [
        { pos: 0.00, color: [255, 255, 255] },
        { pos: 0.14, color: [147, 112, 219] },
        { pos: 0.29, color: [100, 181, 246] },
        { pos: 0.43, color: [102, 187, 106] },
        { pos: 0.57, color: [255, 235, 59] },
        { pos: 0.71, color: [239, 83, 80] },
        { pos: 1.00, color: [136, 14, 79] }
      ];

      let lower = stops[0];
      let upper = stops[stops.length - 1];

      for (let i = 0; i < stops.length - 1; i++) {
        if (normalized >= stops[i].pos && normalized <= stops[i + 1].pos) {
          lower = stops[i];
          upper = stops[i + 1];
          break;
        }
      }

      const range = upper.pos - lower.pos;
      const factor = range === 0 ? 0 : (normalized - lower.pos) / range;

      const r = Math.round(lower.color[0] + (upper.color[0] - lower.color[0]) * factor);
      const g = Math.round(lower.color[1] + (upper.color[1] - lower.color[1]) * factor);
      const b = Math.round(lower.color[2] + (upper.color[2] - lower.color[2]) * factor);

      return `rgb(${r}, ${g}, ${b})`;
    }

    // Generate weather data
    function generateWeatherData() {
      const data = [];
      const baseTime = new Date();
      baseTime.setMinutes(0, 0, 0);

      for (let i = 0; i < 48; i++) {
        const time = new Date(baseTime.getTime() + i * 3600000);
        const hour = time.getHours();

        const dayProgress = (hour - 6) / 12;
        const tempBase = 60 + Math.sin(dayProgress * Math.PI) * 12;
        const temp = tempBase + (Math.random() - 0.5) * 8;

        const precipBase = hour >= 4 && hour <= 8 ? 40 : 15;
        const precip = Math.max(0, Math.min(100, precipBase + (Math.random() - 0.5) * 30));

        const windSpeed = 5 + Math.random() * 15;
        const windDir = Math.floor(Math.random() * 360);
        const clouds = Math.max(0, Math.min(100, 30 + (Math.random() - 0.5) * 40));
        const humidity = (hour >= 20 || hour <= 6 ? 75 : 55) + Math.round((Math.random() - 0.5) * 10);

        data.push({
          time,
          temp: Math.round(temp),
          precip: Math.round(precip),
          windSpeed: Math.round(windSpeed),
          windDir,
          clouds: Math.round(clouds),
          humidity,
          dewPoint: Math.round(temp - 15)
        });
      }

      return data;
    }

    const weatherData = generateWeatherData();
    let currentMetric = 'temperature';
    let rotationAngle = 0;

    // Draw spiral visualization
    function drawSpiral() {
      const svg = document.getElementById('spiral');
      const centerX = 200;
      const centerY = 200;
      const maxRadius = 180;
      const minRadius = 80;
      const totalHours = 48;

      // Clear previous content
      document.getElementById('grid-circles').innerHTML = '';
      document.getElementById('spiral-path').innerHTML = '';
      document.getElementById('hour-markers').innerHTML = '';
      document.getElementById('data-viz').innerHTML = '';
      document.getElementById('interactive-layer').innerHTML = '';

      // Draw grid circles
      for (let i = 0; i < 4; i++) {
        const r = minRadius + (maxRadius - minRadius) * (i / 3);
        const circle = `<circle cx="${centerX}" cy="${centerY}" r="${r}"
                       stroke="rgba(255,255,255,0.05)" stroke-width="1" fill="none"/>`;
        document.getElementById('grid-circles').innerHTML += circle;
      }

      // Draw spiral segments
      weatherData.forEach((data, i) => {
        const angle = (i / totalHours) * Math.PI * 4; // 2 full rotations
        const radius = minRadius + (maxRadius - minRadius) * (i / totalHours);
        const nextAngle = ((i + 1) / totalHours) * Math.PI * 4;
        const nextRadius = minRadius + (maxRadius - minRadius) * ((i + 1) / totalHours);

        const x1 = centerX + Math.cos(angle) * radius;
        const y1 = centerY + Math.sin(angle) * radius;
        const x2 = centerX + Math.cos(nextAngle) * nextRadius;
        const y2 = centerY + Math.sin(nextAngle) * nextRadius;

        // Temperature segments
        if (currentMetric === 'temperature' || currentMetric === 'combined') {
          const segment = `<line x1="${x1}" y1="${y1}" x2="${x2}" y2="${y2}"
                         stroke="${getTemperatureColor(data.temp)}"
                         stroke-width="8" stroke-linecap="round" opacity="0.8"/>`;
          document.getElementById('spiral-path').innerHTML += segment;
        }

        // Precipitation dots
        if ((currentMetric === 'precipitation' || currentMetric === 'combined') && data.precip > 20) {
          const size = 3 + (data.precip / 100) * 10;
          const precipDot = `<circle cx="${x1}" cy="${y1}" r="${size}"
                           fill="#64b5ff" opacity="${0.3 + data.precip / 200}"/>`;
          document.getElementById('data-viz').innerHTML += precipDot;
        }

        // Wind indicators
        if ((currentMetric === 'wind' || currentMetric === 'combined') && i % 3 === 0) {
          const arrowLength = 15;
          const arrowAngle = (data.windDir * Math.PI) / 180;
          const arrowX2 = x1 + Math.cos(arrowAngle) * arrowLength;
          const arrowY2 = y1 + Math.sin(arrowAngle) * arrowLength;

          const arrow = `<line x1="${x1}" y1="${y1}" x2="${arrowX2}" y2="${arrowY2}"
                       stroke="#9575cd" stroke-width="2" marker-end="url(#arrowhead)"/>`;
          document.getElementById('data-viz').innerHTML += arrow;
        }

        // Hour markers
        if (i % 6 === 0) {
          const marker = `<circle cx="${x1}" cy="${y1}" r="4"
                        fill="white" opacity="0.5"/>`;
          document.getElementById('hour-markers').innerHTML += marker;
        }

        // Interactive areas
        const interactiveArea = `<circle cx="${x1}" cy="${y1}" r="15"
                                fill="transparent" data-hour="${i}"
                                style="cursor: pointer" class="interactive-segment"/>`;
        document.getElementById('interactive-layer').innerHTML += interactiveArea;
      });

      // Add arrow marker definition
      const arrowMarker = `
        <defs>
          <marker id="arrowhead" markerWidth="10" markerHeight="10"
                  refX="5" refY="5" orient="auto">
            <polygon points="0,0 10,5 0,10" fill="#9575cd"/>
          </marker>
        </defs>
      `;
      document.getElementById('data-viz').innerHTML = arrowMarker + document.getElementById('data-viz').innerHTML;

      // Add time labels
      addTimeLabels();

      // Add click handlers
      document.querySelectorAll('.interactive-segment').forEach(segment => {
        segment.addEventListener('click', (e) => {
          const hour = parseInt(e.target.dataset.hour);
          showDetail(weatherData[hour]);
        });
      });
    }

    // Add time labels around the spiral
    function addTimeLabels() {
      const container = document.getElementById('timeLabels');
      container.innerHTML = '';

      const labelHours = [0, 6, 12, 18, 24, 30, 36, 42];
      const centerX = 50;
      const centerY = 50;

      labelHours.forEach(hour => {
        if (hour >= weatherData.length) return;

        const angle = (hour / 48) * Math.PI * 4 - Math.PI / 2;
        const radius = 20 + 60 * (hour / 48);
        const x = centerX + Math.cos(angle) * radius;
        const y = centerY + Math.sin(angle) * radius;

        const timeStr = weatherData[hour].time.toLocaleTimeString('en-US', {
          hour: 'numeric',
          hour12: true
        });

        const label = document.createElement('div');
        label.className = 'time-label';
        label.textContent = hour === 0 ? 'NOW' : timeStr;
        label.style.left = `${x}%`;
        label.style.top = `${y}%`;

        container.appendChild(label);
      });
    }

    // Show detail card
    function showDetail(data) {
      const timeStr = data.time.toLocaleString('en-US', {
        weekday: 'short',
        hour: 'numeric',
        hour12: true
      });

      document.getElementById('detailTime').textContent = timeStr;
      document.getElementById('detailTemp').textContent = `${data.temp}Â°`;
      document.getElementById('detailTemp').style.color = getTemperatureColor(data.temp);
      document.getElementById('detailPrecip').textContent = `${data.precip}%`;
      document.getElementById('detailWind').textContent = `${data.windSpeed} mph`;
      document.getElementById('detailHumidity').textContent = `${data.humidity}%`;
      document.getElementById('detailDew').textContent = `${data.dewPoint}Â°`;
      document.getElementById('detailClouds').textContent = `${data.clouds}%`;

      document.getElementById('detailCard').classList.add('active');
    }

    // Close detail card
    function closeDetail() {
      document.getElementById('detailCard').classList.remove('active');
    }

    // Metric switching
    document.querySelectorAll('.metric-button').forEach(button => {
      button.addEventListener('click', () => {
        document.querySelectorAll('.metric-button').forEach(b => b.classList.remove('active'));
        button.classList.add('active');
        currentMetric = button.dataset.metric;
        drawSpiral();
      });
    });

    // Touch rotation
    let isDragging = false;
    let startAngle = 0;
    let currentRotation = 0;

    const spiral = document.getElementById('spiral');

    spiral.addEventListener('mousedown', startDrag);
    spiral.addEventListener('touchstart', startDrag);

    function startDrag(e) {
      isDragging = true;
      const rect = spiral.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;

      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;

      startAngle = Math.atan2(clientY - centerY, clientX - centerX);
    }

    document.addEventListener('mousemove', drag);
    document.addEventListener('touchmove', drag);

    function drag(e) {
      if (!isDragging) return;

      const rect = spiral.getBoundingClientRect();
      const centerX = rect.left + rect.width / 2;
      const centerY = rect.top + rect.height / 2;

      const clientX = e.touches ? e.touches[0].clientX : e.clientX;
      const clientY = e.touches ? e.touches[0].clientY : e.clientY;

      const currentAngle = Math.atan2(clientY - centerY, clientX - centerX);
      const rotation = (currentAngle - startAngle) * (180 / Math.PI);

      spiral.style.transform = `rotate(${-90 + currentRotation + rotation}deg)`;
    }

    document.addEventListener('mouseup', endDrag);
    document.addEventListener('touchend', endDrag);

    function endDrag(e) {
      if (isDragging) {
        const rect = spiral.getBoundingClientRect();
        const centerX = rect.left + rect.width / 2;
        const centerY = rect.top + rect.height / 2;

        const clientX = e.changedTouches ? e.changedTouches[0].clientX : e.clientX;
        const clientY = e.changedTouches ? e.changedTouches[0].clientY : e.clientY;

        const currentAngle = Math.atan2(clientY - centerY, clientX - centerX);
        const rotation = (currentAngle - startAngle) * (180 / Math.PI);

        currentRotation += rotation;
      }
      isDragging = false;
    }

    // Initialize
    drawSpiral();

    // Update current temperature
    document.getElementById('currentTemp').textContent = `${weatherData[0].temp}Â°`;
    document.getElementById('currentTemp').style.color = getTemperatureColor(weatherData[0].temp);
  </script>
</body>
</html>